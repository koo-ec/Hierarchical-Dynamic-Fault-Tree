%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Program Name : Semi-Markov Analysis                                     %
% Author       : Koorosh Aslansefat                                       %
% Version      : 3                                                        %
% Description  : Solve SEQ by means of Semi-Markov Model                  %
%                                                                         %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Clear Section
% Clear
clear all
close all
clc

format long
%% SEQ
syms s t Fa Fb Fc Q12 Q13 Q14 Q25 Q26 Q37 Q38 Q49 Q410
P0 = [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
K_s = [0, Q12, Q13, Q14,   0,   0,   0,   0,   0,    0,    0,    0
       0, 0,     0,   0, Q25, Q26,   0,   0,   0,    0,    0,    0
       0, 0,     0,   0,   0,   0, Q37, Q38,   0,    0,    0,    0 
       0, 0,     0,   0,   0,   0,   0,   0, Q49, Q410,    0,    0
       0, 0,     0,   0,   0,   0,   0,   0,   0,    0, 1-Fc,    0
       0, 0,     0,   0,   0,   0,   0,   0,   0,    0,    0, 1-Fb
       0, 0,     0,   0,   0,   0,   0,   0,   0,    0,    0, 1-Fc
       0, 0,     0,   0,   0,   0,   0,   0,   0,    0,    0, 1-Fa
       0, 0,     0,   0,   0,   0,   0,   0,   0,    0,    0, 1-Fb
       0, 0,     0,   0,   0,   0,   0,   0,   0,    0,    0, 1-Fa
       0, 0,     0,   0,   0,   0,   0,   0,   0,    0,    0,    0
       0, 0,     0,   0,   0,   0,   0,   0,   0,    0,    0,    0];
   
E_s = [1-Fa*Fb*Fc,0,0,0,   0,   0,   0,   0,   0,    0,    0,    0
       0, 1-Fc*Fb,0,  0,   0,   0,   0,   0,   0,    0,    0,    0
       0, 0,1-Fa*Fc,  0,   0,   0,   0,   0,   0,    0,    0,    0 
       0, 0,     0,1-Fa*Fb,0,   0,   0,   0,   0,    0,    0,    0
       0, 0,     0,   0,1-Fc,   0,   0,   0,   0,    0,    0,    0
       0, 0,     0,   0,   0,1-Fb,   0,   0,   0,    0,    0,    0
       0, 0,     0,   0,   0,   0,1-Fc,   0,   0,    0,    0,    0
       0, 0,     0,   0,   0,   0,   0,1-Fa,   0,    0,    0,    0
       0, 0,     0,   0,   0,   0,   0,   0,1-Fb,    0,    0,    0
       0, 0,     0,   0,   0,   0,   0,   0,   0, 1-Fa,    0,    0
       0, 0,     0,   0,   0,   0,   0,   0,   0,    0,    0,    0
       0, 0,     0,   0,   0,   0,   0,   0,   0,    0,    0,    0];

       
I = eye(size(K_s,1));
K_s_inv = 0;

for ii = 0:100
    K_s_inv = K_s_inv + (K_s)^ii;
end

V_s = K_s_inv*(I - E_s);
P = P0*V_s;
pretty(P)